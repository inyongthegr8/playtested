---
import { type CollectionEntry } from "astro:content";
import SiteOptions from "../site.config.mjs";
import ScoreBadge from "./ScoreBadge.astro";
import { Image } from 'astro:assets';

export interface Props {
  post: CollectionEntry<"article">;
}

const { post } = Astro.props;
const { title, description, thumb, score } = post.data;
const roundedScore = typeof score === 'number' ? Math.round(score) : null;
---
<article class="bg-gray-50 dark:bg-slate-800 rounded-lg shadow-sm p-6 flex flex-col items-start">
  {
    SiteOptions.showThumbnailOnFeaturedPosts && thumb && (
      <a href={`/article/${post.slug}`} class="w-full block group relative featured-card-thumb">
        <div class="w-full aspect-w-16 aspect-h-9 mb-6 rounded-xl overflow-hidden shadow-md max-w-4xl mx-auto relative">
          <Image
            src={thumb}
            alt={title}
            width={640}
            height={360}
            loading="eager"
            class="w-full h-full object-cover"
            placeholder="blur"
          />
          <ScoreBadge score={roundedScore} />
        </div>
      </a>
    )
  }

  <h3 class="text-xl font-bold mb-2">
    <a href={`/article/${post.slug}`}>{title}</a>
  </h3>

  <p class="text-gray-500 dark:text-gray-400 text-sm mb-4 flex-grow desc-clamp">
    {description}
  </p>

  {
    SiteOptions.showReadMoreLinkOnFeaturedPosts && (
      <a
        href={`/article/${post.slug}`}
        class="text-black dark:text-white underline text-sm mt-auto self-start"
      >
        {SiteOptions.labels.readMore}
      </a>
    )
  }
</article>
